<html lang="ja">
  <head>
    <title>expand_theorem</title>
    <script type="text/x-mathjax-config">
       MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}});
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML,/www_func/MathJax/MyConfig.js">
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=py&skin=sunburst"></script>
  </head>
  <body>
  <strong>このページは、pdfファイル出力用に作成したtexファイルから機械的に変換されています。体裁不良がある場合は<a href="https://github.com/haru-44/prime_text/releases/latest/download/main.pdf">pdfファイル</a>をご覧ください。</strong>
  <hr/>
<h1>expand_theorem</h1>
<p><h2>Wieferich素数</h2>
どんな素数でも成り立つ式があるとする。
例えばFermatの小定理は、\(p\)が奇素数なら
\begin{align*}
2^{p-1} \equiv 1 \pmod{p}
\end{align*}
を満たすのであった。
では、条件をもっと絞ったらどうなるだろうか。
例えば、
\begin{align*}
2^{p-1} \equiv 1 \pmod{p^2}
\end{align*}
を満たす素数\(p\)は存在するだろうか？　このような素数をWieferich素数と呼ぶ。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>定義</strong>)
素数\(p\)が、
\begin{align*}
2^{p-1} \equiv 1 \pmod{p^2}
\end{align*}
を満たすとき、Wieferich素数と呼ぶ。
</div>

<p>現在知られているWieferich素数は1093と3511のみである{<a href="https://oeis.org/A001220">https://oeis.org/A001220</a>}。
</p>
<p>他にも、を参考して、Lucas-Wieferich素数というものも考えることができる。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>定義</strong>)
\(\Delta=a^2-4b\)は平方数でないとする。
\(p\)が\(\gcd(p, 2b\Delta)=1\)を満たす素数で、
\begin{align*}
U_{p - \left(\frac{\Delta}{p}\right)} \equiv 0 \pmod{p^2}
\end{align*}
を満たすなら、\(p\)をパラメータ\((a,b)\)に関するLucas-Wieferich素数と呼ぶ。
</div>

<p>更に、を参考にすれば、次のような素数を考えることができるが、Fibonacci-Wieferich素数は未だ見つかっていない。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>定義</strong>)
素数\(p\)がパラメータ\((1,-1)\)に関するLucas-Wieferich素数であるとき、Fibonacci-Wieferich素数あるいはWall-Sun-Sun素数と呼ぶ。
</div>

<p>Fibonacci-Wieferich素数が興味深いのは、Fermatの最終定理に関連していることだ。
(既にWilesによって証明されているが、)Fermatの最終定理が偽だったとしよう。
最初の反例の指数\(p\)は、Fibonacci-Wieferich素数でなければならない。
つまり、未証明の状況下において、Fibonacci-Wieferich素数を探すことは、Fermatの最終定理の反例候補を探すことでもあったのだ。
</p>
<p><h2>Wolstenholme素数</h2>
</p>
<p>\begin{align*}
{2p-1 \choose p-1} \equiv 1 \pmod{p^3}
\end{align*}
は、\(p\ge5\)なる素数で成り立つが、\(p^4\)に変更すると、合同式を満たす素数はぐっと減る。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>定義</strong>)
素数\(p\)が、
\begin{align*}
{2p-1 \choose p-1} \equiv 1 \pmod{p^4}
\end{align*}
を満たすとき、Wolstenholme素数と呼ぶ。
</div>

<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>定理</strong>)
\(p\ge11\)を素数とする。
次の3つは同値である。
<ol>
 <li> \(p\)はWolstenholme素数
 <li> \(p\)は\(B_{p-3}\)の分子を割り切る。ここで、\(B_n\)は\(n\)番目のBernoulli数。
 <li> \(\sum_{p/6<k<p/4}\frac{1}{k^3} \equiv 0 \pmod{p}\)
</ol>
</div>

<p>2022年7月現在、知られているWolstenholme素数は、16843と2124679のみである。
これら以外のWolstenholme素数について、2007年には\(10^9\)以下には存在しないことが確認され、2022年には\(10^{11}\)以下には存在しないことが確認されている{<a href="https://oeis.org/A088164">https://oeis.org/A088164</a>}。
</p>
<p>素数\(p\)がWolstenholme素数かどうかは、の3を使ってもよいが、逆元の計算が必要となる。
で指摘されているように、多項式
\begin{align*}
\prod_{p/6<k<p/4} (x+k^3)
\end{align*}
の\(x\)の係数が\(p\)を法として0と合同かを調べればWolstenholme素数かが分かる。
念のため、根と係数の関係より\(x\)の係数は
\begin{align*}
\left(\prod_{p/6<k<p/4}k^3\right)\left(\sum_{p/6<k<p/4}\frac{1}{k^3}\right)
\end{align*}
となることに注意しておく。
よって、実装する際も単純に多項式を展開していくだけでよいが{2次以上の項は無視してよいし、係数も\(\bmod{p}\)で考えてよい。}、では高速化のため\(k^3\)を足し算のみで計算するようにしている。
</p>
<pre class="prettyprint">def is_wolstenholme_prime(p: int) -> bool:
    """ p がWolstenholme素数かを判定する

    Args:
        p (int): 11<=p である素数

    Returns:
        bool: pがWolstenholme素数ならTrue

    Examples:
        >>> is_wolstenholme_prime(16843)
        True
        >>> is_wolstenholme_prime(11)
        False
    """
    k = p//6 + 1
    delta1 = (3*k**2 + 3*k + 1) % p
    delta2 = 12 - (p % 6)
    k3 = pow(k, 3, p)
    coef0, coef1 = 1, 0
    for _ in range(k, p//4 + 1):
        coef0, coef1 = (coef0 * k3) % p, (coef0 + coef1 * k3) % p
        k3 = (k3 + delta1) % p
        delta1 = (delta1 + delta2) % p
        delta2 = (delta2 + 6) % p
    return coef1 == 0
</pre>


</body></html>