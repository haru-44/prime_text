<html lang="ja">
  <head>
    <title>gauss_sum</title>
    <script type="text/x-mathjax-config">
       MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}});
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML,/www_func/MathJax/MyConfig.js">
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=py&skin=sunburst"></script>
  </head>
  <body>
  <strong>このページは、pdfファイル出力用に作成したtexファイルから機械的に変換されています。体裁不良がある場合は<a href="https://github.com/haru-44/prime_text/releases/latest/download/main.pdf">pdfファイル</a>をご覧ください。</strong>
  <hr/>
<h1>gauss_sum</h1>
<p><h2>1の原始\(n\)乗根と円分多項式</h2>
1の\(n\)乗根とは、\(n\)乗して1になる数のことである。
ここでは複素数で考えよう{既に学んだように、どんな数を考えているかによって\(n\)乗根も変わる。}。
その中でも、1の<strong>原始</strong>\(n\)乗根とは、\(n\)乗して<strong>初めて</strong>1になる複素数である。
</p>
<p>例えば、1の4乗根は\(1,-1,i,-i\)の4つあるが、原始4乗根は\(i,-i\)の2つである。
\(-1\)は2乗すると1になってしまうので原始4乗根ではない。
1の3乗根は1と\(\frac{-1+\sqrt{-3}}{2},\frac{-1-\sqrt{-3}}{2}\)だが、後者2つは2乗しても1にならないから2つとも原始3乗根である。
</p>
<p>\(e^{\frac{2\pi i}{n}}\)は1の原始\(n\)乗根であるから、これを\(\zeta_n=e^{\frac{2\pi i}{n}}\)と書くことにしよう。
このとき、次が成り立つ。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>命題</strong>)\;
<ol>
 <li> \(\zeta_n^0,\zeta_n^1,\zeta_n^2,\ldots,\zeta_n^{n-1}\)は相異なり、これが1の\(n\)乗根のすべてである。
 <li> \(a\equiv b \pmod{n} \iff \zeta_n^a = \zeta_n^b\)
 <li> 任意の整数\(k\)について、\(\overline{\zeta_n^k} = \zeta_n^{-k}\)。ここで、\(\overline{z}\)は\(z\)の複素共役。
 <li> \(\sum_{k=0}^{n-1} \zeta_n^k = 0\)
</ol>
</div>

<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>定義</strong>)
\(n\)次の円分多項式\(\Phi_n\)とは、「1の原始\(n\)乗根」を根に持つ、最高次係数が1の多項式である。
</div>

<p>\(\zeta_n^k\)のうち、\(\gcd(n,k)=1\)となる\(k\)のときのみ原始\(n\)乗根となるから、具体的に書くなら次のようになる。
\begin{align*}
\Phi_n(x)=\prod_{\stackrel{1 \le k \le n}{\gcd(k,n)=1}}(x - e^{2\pi ik/n})
\end{align*}
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>例</strong>)\;
<ul>
 <li> \(\Phi_1(x) = x-1\)
 <li> \(\Phi_2(x) = x+1\)
 <li> \(\Phi_3(x) = x^2+x+1\)
</ul>
</div>

<p>原始多項式となる条件からも推察できるように、\(\Phi_n(x)\)は、\(\varphi(n)\)次の多項式である。
一方、\(\Phi_n(x)\)が常に整数係数多項式となることは、定義からすると意外かもしれない。
専ら素数次の円分多項式を使うから、この場合について詳しく見てみよう。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>命題</strong>)
\(p\)を素数とする。
\(p\)次の円分多項式は、次のように書ける。
\begin{align*}
\Phi_p(x) &= \sum_{k=0}^{p-1}x^k\\
&= 1 + x + x^2 + \cdots + x^{p-1}
\end{align*}
</div>

<p>最後に、\(x^n-1\)の分解について見よう。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>命題</strong>)
任意の正整数\(n\)について次が成り立つ。
\begin{align*}
x^n-1 = \prod_{d\mid n} \Phi_d(x)
\end{align*}
</div>

<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>例</strong>)\;
\begin{align*}
x^{12}-1 = \Phi_1(x)\Phi_2(x)\Phi_3(x)\Phi_4(x)\Phi_6(x)\Phi_{12}(x)
\end{align*}
</div>

<p><h2>色々なGauss和</h2>
一口にGauss和と言っても、多種多様なGauss和がある(ように見えてしまう)。
抽象度も高くなるから尻込みもしてしまう。
なるべく抽象度が低い所から進めていこう。
</p>
<p>奇素数\(p\)について、Gauss和\(\tau_p\)を次のように定義する。
\begin{align}\label{eq:tau_p1}
\tau_p = \sum_{n=1}^{p-1} \left(\frac{n}{p}\right) \zeta_p^n
\end{align}
ここで、\(\left(\frac{a}{p}\right)\)はLegendre記号である。
あるいは、正整数\(N\)について、
\begin{align}\label{eq:tau_p2}
\tau_N = \sum_{n=0}^{N-1} \zeta_p^{n^2}
\end{align}
と定義することもある。
奇素数の範囲では一致するから最初の定義を拡張しているとも言えるが、自明と言える程明らかなことではない。
この証明については、\ref{sss:proof_gauss_sum_1}に載せるが、平方剰余の復習にはもってこいの練習問題となるので、自力で解くのも一興である。
</p>
<p>まず、\(\tau_p\)は複素数となる(多項式などにはならない)。
\(\zeta_n\)が複素数なので、その和も複素数なのだ。
つまり、\(p\)さえ与えられれば具体的な値が計算できる。
試しに\(\tau_3\)を計算してみよう。
\(\zeta_3=\frac{-1+\sqrt{-3}}{2}, \zeta_3^2=\frac{-1-\sqrt{-3}}{2}\)であることに注意すると、
\begin{align*}
\tau_3 &= \left(\frac{1}{3}\right)\zeta_3 + \left(\frac{2}{3}\right)\zeta_3^2\\
&=\frac{-1+\sqrt{-3}}{2}-\frac{-1-\sqrt{-3}}{2}\\
&= \sqrt{-3}
\end{align*}
となって、\(\tau_3=\sqrt{-3}\)という、案外シンプルな結果を得た。
ちなみに、もう1つの定義で計算しても\(\zeta_3^4=\zeta_3\)なので、
\begin{align*}
\tau_3 &= \zeta_3^0 + \zeta_3^1 + \zeta_3^4\\
&= 1 + \zeta_3 + \zeta_3\\
&= \sqrt{-3}
\end{align*}
となって一致する。
</p>
<p>次に、\(\tau_5\)を計算してみる。
\(1+\zeta_5+\zeta_5^2+\zeta_5^3+\zeta_5^4=0\)であるから、
\begin{align*}
\tau_5 &= \left(\frac{1}{5}\right)\zeta_5 + \left(\frac{2}{5}\right)\zeta_5^2 + \left(\frac{3}{5}\right)\zeta_5^3 + \left(\frac{4}{5}\right)\zeta_5^4\\
&= \zeta_5-\zeta_5^2-\zeta_5^3+\zeta_5^4\\
&= -(1+\zeta_5+\zeta_5^2+\zeta_5^3+\zeta_5^4)+1+2(\zeta_5+\zeta_5^4)\\
&= 1+2(\zeta_5+\zeta_5^4)
\end{align*}
となって、途中端折ってしまうが、\(\zeta_5+\zeta_5^4=\frac{-1+\sqrt{5}}{2}\)なので、結局\(\tau_5=\sqrt{5}\)となる。
こうしてみると、\(\tau_p\)の値は薄々想像ができるだろう。
Gaussは次を証明した。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>命題</strong>)
任意の奇素数\(p\)について
\begin{align*}
\tau_p = 
\begin{cases}
\sqrt{p}, &\mbox{if } p \equiv 1 \pmod{4}\\
\sqrt{-p}, &\mbox{if } p \equiv 3 \pmod{4}
\end{cases}
\end{align*}
</div>

<p>元々Gauss和は、平方剰余の相互法則を証明する道具として導入された。
もちろん、この命題を使って平方剰余の相互法則を証明することもできるのだが、如何せんこの命題自体を証明することが簡単ではない。
\(\tau_p^2\)を決定することは比較的簡単で、それだけでも証明が可能なので、こちらのルートで証明する方法もある。
</p>
<p>次に、2次Gauss和を定義しよう。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>定義</strong>)
奇素数\(p\)と\(p \nmid a\)なる整数\(a\)について、2次Gauss和\(G(a;p)\)を次のように定義する。
\begin{align*}
G(a;p) = \sum_{n=1}^{p-1} \left(\frac{n}{p}\right) \zeta_p^{an}
\end{align*}
ここで、\(\left(\frac{a}{p}\right)\)はLegendre記号である。
</div>

<p>明らかに\(G(1; p)=\tau_p\)である。
\(\tau_p\)のときと同様に、正整数\(N\)において
\begin{align*}
G(a; N) = \sum_{n=0}^{N-1} \zeta_p^{an^2}
\end{align*}
と定義してもよい。
</p>
<p>\(G(a;p)\)と\(G(1;p)\)はLegendre記号でつながる。
</p><div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>命題</strong>)
奇素数\(p\)と\(p \nmid a\)なる整数\(a\)に対して
\begin{align*}
G(a; p) = \left(\frac{a}{p}\right) G(1;p)
\end{align*}
が成り立つ。
</div>

<p>素数判定を行うには、まだまだ一般化が足りない。
これまでLegendre記号を使ってきたが、Dirichlet指標()に拡張しよう。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>定義</strong>)
Dirichlet指標\(\chi:\mathbb{Z}_n^*\to\mathbb{C}^*\)と1の原始\(N\)乗根\(\zeta_N\)について、
\begin{align*}
G(\chi, \zeta_N) = \sum_{n=1}^{N} \chi(n) \zeta_N^{n}
\end{align*}
をGauss和\(G(\chi, \zeta_N)\)と定義する。
ここで、\(N\)と互いに素でない\(n\)については\(\chi(n)=0\)と定める。
</div>

<p>は、の拡張と見ることができるだろう。
原始的なDirichlet指標という条件が付くが、ここで扱う指標はすべて原始的だからあまり気にしない。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>命題</strong>)
原始的なDirichlet指標\(\chi:\mathbb{Z}_n^*\to\mathbb{C}^*\)と整数\(a\)に対して、次が成り立つ。
\begin{align*}
G(\chi, \zeta_N^a) = \overline{\chi}(a)G(\chi, \zeta_N)
\end{align*}
</div>

<p>さらに、の拡張としてが得られる。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>命題</strong>)
原始的なDirichlet指標\(\chi:\mathbb{Z}_n^*\to\mathbb{C}^*\)に対して、次が成り立つ。
\begin{align*}
|G(\chi, \zeta_N)| = \sqrt{N}
\end{align*}
</div>

<p>ここまで、素数判定に必要なGauss和の知識を駆け足(というよりも全速力)で駆け抜けた。
ここからは、具体的な\(\chi\)について議論する。
\(\chi\)として、\(\chi_{p,q}(g_q^k)=\zeta_p^k\)を使ってみよう。
ここで、\(q\)は素数、\(p\)は\(q-1\)の素因数、\(g_q\)は\(q\)の最小原始根とする。
すると、\(G(\chi_{p,q}, \zeta_q)\)は
\begin{align*}
G(\chi_{p,q}, \zeta_q) = \sum_{k=1}^{q-1} \zeta_p^{k \bmod{p}}\zeta_q^{g_q^k \bmod{q}}
\end{align*}
となる。
ここまできてやっと、Fermatの小定理と類似した、素数判定に使えそうな命題が現れる。
</p>
<div style="padding: 10px; margin-bottom: 10px; border: 1px solid #000000;">(<strong>命題</strong>)
\(p,q,n\)を素数とする。
ただし、\(p \mid q-1\)と\(\gcd(pq, n)=1\)を満たすとする。
このとき、
\begin{align*}
G(\chi_{p,q}, \zeta_q)^{n^{p-1}-1} \equiv \chi_{p,q}(n) \pmod{n}
\end{align*}
が成り立つ。
</div>



</body></html>