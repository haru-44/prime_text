「$n$の因数は、$s$を法として$r$と合同」という事実が判明したとする。
このことは、$n$の素数判定あるいは素因数分解に役立つだろうか？　すぐに、試し割は$xs+r$の形のみを行えば良いことが分かる\Notes{$x$を動かせばよい}。
他にも$r=1$なら$p-1$法が使えるし、$r=s-1$なら$p+1$法が使える。

ここでは、Lenstraの結果\cite{divisors_lenstra}を紹介しよう。
このアルゴリズムは、$s$を法として$r$と合同な$n$の非自明な約数を列挙することができる。
残念ながら、このアルゴリズムには人口に膾炙した名前はない\Notes{ふつう「Lenstra法」と言えば楕円曲線を使った素因数分解アルゴリズムを指す。}。

仮定より、
\begin{align*}
n = (xs+r)(ys+r')
\end{align*}
と書ける、$x,y\ge0$と$0<r'<s$が存在する。

\Algo{剰余類に含まれる因数}{divisors_lenstra}{c.f., \rAlgo{inverse_mod}, \rAlgo{is_square_number}, \rAlgo{sqrt_int}}

